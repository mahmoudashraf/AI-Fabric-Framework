# Test Profile Configuration for Integration Tests
# This configuration ensures ONNX embedding provider is used for tests

# Test Profile Configuration for Integration Tests
# This configuration ensures ONNX embedding provider is used for tests

ai:
  enabled: true
  pii-detection:
    enabled: true
    mode: DETECT_ONLY
    patterns:
      API_KEY:
        field-name: api_key
        regex: "sk-[A-Za-z0-9]{12,}"
        enabled: true
        replacement: ""
        confidence: 1.0
        context-note: API key redacted

  providers:
    # Embedding Provider Configuration (ONNX for testing)
    embedding-provider: ${EMBEDDING_PROVIDER:onnx}
    onnx-model-path: ${ONNX_MODEL_PATH:classpath:/models/embeddings/all-MiniLM-L6-v2.onnx}
    onnx-tokenizer-path: ${ONNX_TOKENIZER_PATH:classpath:/models/embeddings/tokenizer.json}
    onnx-max-sequence-length: 512
    onnx-use-gpu: false
    
    # OpenAI Configuration (disabled for tests - use ONNX)
    openai-api-key: ${OPENAI_API_KEY:test-key}
    openai-model: gpt-4o-mini
    openai-embedding-model: text-embedding-3-small
    
  # Vector Database Configuration - Memory for fast tests
  vector-db:
    type: memory
    lucene:
      index-path: ./data/test-lucene-index

  response-sanitization:
    enabled: true
    force-redaction: true
    warning-enabled: true
    guidance-enabled: true
    include-suggestion-metadata: true
    publish-events: true

# Logging for Test Profile
logging:
  level:
    root: INFO
    com.ai.infrastructure: DEBUG
    com.ai.infrastructure.embedding: DEBUG
    org.springframework: WARN



